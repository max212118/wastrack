<div class="container-dashboard">
  <div class="cards">

    <div id="mapdiv">
      <div class="card-category" style="width: 100%; height: 100%;">
        <div style="width: 100%; height: 100%;"
            data-controller="mapbox"
            data-mapbox-markers-value="<%= @markers.to_json %>"
            data-mapbox-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
        </div>
      </div>
    </div>

	<div id="infodiv" class="card-category">
		<div class="info-title">
			<h2>INFOS</h2>
			<h3><%= localize( Date.today, format: '%B') %></h3>
		</div>
		<div class="info-content">
			<section class="statis mt-4 text-center">
				<div class="info-top-d-flex">
					<div class="info-comp">
						<div class="box bg-warning p-3">
							<i class="fa-solid fa-trash"></i>
							<h3>3</h3>
							<p class="lead">Containers pleins depuis 2j+</p>
						</div>
					</div>
					<div class="info-comp">
						<div class="box bg-success p-3">
							<%# <i class="fa-solid fa-timer"></i> %>
							<i class="fa-solid fa-clock"></i>
								<h3>2j</h3>
							<p class="lead">Temps de remplissage</p>
						</div>
					</div>
				</div>
				<div class="info-bot-d-flex">
					<div class="info-comp">
					<% if @dist_moyenne < 30 %>
						<div class="box bg-success p-3">
					<% elsif @dist_moyenne < 60 %>
						<div class="box bg-warning p-3">
					<% else %>
						<div class="box bg-danger p-3">
					<% end %>
							<i class="fa-solid fa-bus"></i>
							<h3> <%= @dist_moyenne %> km</h3>
							<p class="lead">Distance moyenne par jour</p>
						</div>
					</div>
					<div class="info-comp">
					<%# en dur pour l'instant: %>
						<div class="box bg-success p-3">
						<i class="fa-solid fa-comment-medical"></i>
						<h3>0</h3>
						<p class="lead">Problèmes en attentes</p>
						</div>
					</div>
				</div>
			</section>
		</div>
	</div>


	<%# <div id="graphdiv">
      <div class="card-category">
        <div class="button-container d-flex justify-content-around">
          <div class="btn btn-success" id="day">Jour</div>
          <div class="btn btn-success" id="week">Semaine</div>
          <div class="btn btn-success" id="month">Mois</div>
        </div> %>
        <%# <div class="active" id="day-chart" data-hello_controller-target="chart"> %>
			<%#= column_chart ContainerFillingLevel.group_by_day(:at).average(:level), defer: true, height: "400px", colors: ["#85C883"]%>
		<%# </div>
        <div class="d-none" id="week-chart" data-hello_controller-target="chart"> %>
			<%#= column_chart ContainerFillingLevel.group_by_week(:at).average(:level), defer: true, height: "400px", colors: ["#85C883"]%>
		<%# </div>
        <div class="d-none" id="month-chart" data-hello_controller-target="chart"> %>
			<%#= column_chart ContainerFillingLevel.group_by_month(:at).average(:level), defer: true, height: "400px", colors: ["#85C883"]%>
		<%# </div>
      </div>
    </div> %>

    <div id="truckdiv">
      <div class="card-category" style="width: 100%; height: 400px;">
        <%# <h1 class="card-title">Flotte</h1> %>
        <div class= "container-plates">
          <ul>
            <%count = 1%>
            <% @trucks.each do |truck| %>
              <div class="container-plate-driver d-flex justify-content-between">

              <!-- Modal -->
              <div class="modal fade" id="modal_<%= truck.id %>" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLabel">INFORMATION</h5>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                      <%= render "trucks/truckshow", truck: truck, count: count %>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                  </div>
                </div>
              </div>
                <div class="container-plate" data-bs-toggle="modal" data-bs-target="#modal_<%= truck.id %>">
                  <li><span class="registration-ui"><%= truck.plate_number %></span>
                </div>
                <div class="plate-driver">
                  </li>
                </div>
              </div>
              <% count += 1 %>
            <% end %>
          </ul>
        </div>
      </div>
    </div>

    <div id="savingsdiv">
      <div id="savings-card" class="card-category" style="width: 100%; height: 400px;">
        <h1 class="card-title">Rapport</h1>
        <%# <div id="savings-card-all"> %>
          <%# <div id="savings-card-text"> %>
            <%# <h5> • Co2 :</h5>
        <div id="savings-card-all">
          <div id="savings-card-text">
            <h5> • Co2 :</h5>
            <h5> • Km :</h5>
            <h5> • Argent :</h5>
            <h5> • Temps :</h5> %>
            <div class="d-flex-all">
              <div class="d-flex" style="justify-content: space-between;">
                <div class="co2 rapport">
                  <h4>CO2:</h4>
                  <div>
                      15000 kg
                  </div>
                </div>
                <div class="km rapport">
                  <h4>KM:</h4>
                  <div>
                      4500 km
                  </div>
                </div>
              </div>
              <div class="d-flex" style="justify-content: space-between;">
                <div class="Argent rapport">
                  <h4>Argent</h4>
                  <div>
                      7000 €
                  </div>
                </div>
                <div class="temps rapport">
                  <h4>Temps:</h4>
                  <div>
                      120 h
                  </div>
                </div>
              </div>
            </div>
          <%# </div> %>
        <%# </div> %>
      </div>
    </div>
  </div>
</div>

<%# 
<script>
var select_format = () => {
  day = document.getElementById("day");
  week = document.getElementById("week");
  month = document.getElementById("month");

  day.addEventListener("click", (event) => {
     document.getElementById("day-chart").classList.add("active");
     document.getElementById("day-chart").classList.remove("d-none");
     document.getElementById("week-chart").classList.add("d-none");
     document.getElementById("month-chart").classList.add("d-none");

  });

  week.addEventListener("click", (event) => {
    document.getElementById("week-chart").classList.add("active");
    document.getElementById("week-chart").classList.remove("d-none");
    document.getElementById("day-chart").classList.add("d-none");
    document.getElementById("month-chart").classList.add("d-none");
  });

  month.addEventListener("click", (event) => {
     document.getElementById("month-chart").classList.add("active");
     document.getElementById("month-chart").classList.remove("d-none");
       document.getElementById("week-chart").classList.add("d-none");
     document.getElementById("day-chart").classList.add("d-none");
  });
}

select_format();
</script> %>
